{"version":3,"sources":["../src/index.js"],"names":["tracer","DEFAULT_CONFIG","sampler","type","param","reporter","logSpans","DEFAULT_OPTIONS","logger","info","msg","console","log","error","init","config","options","tracerConfig","tracerOptions","getParentSpan","format","injectData","extract","startSpan","spanName","spanOptions","R","omit","parentSpanContext","isChild","childOf","isFollowFrom","references","inject","span","payload"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;;;;;;;;;AAEA,IAAIA,MAAJ;AAEA,IAAMC,cAAc,GAAG;AACrBC,EAAAA,OAAO,EAAE;AACPC,IAAAA,IAAI,EAAE,OADC;AAEPC,IAAAA,KAAK,EAAE;AAFA,GADY;AAKrBC,EAAAA,QAAQ,EAAE;AACRC,IAAAA,QAAQ,EAAE;AADF;AALW,CAAvB;AAUA,IAAMC,eAAe,GAAG;AACtBC,EAAAA,MAAM,EAAE;AACNC,IAAAA,IADM,gBACDC,GADC,EACI;AACRC,MAAAA,OAAO,CAACC,GAAR,CAAY,SAAZ,EAAuBF,GAAvB;AACD,KAHK;AAING,IAAAA,KAJM,iBAIAH,GAJA,EAIK;AACTC,MAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ,EAAwBF,GAAxB;AACD;AANK;AADc,CAAxB;;AAWA,IAAMI,IAAI,GAAG,SAAPA,IAAO,CAACC,MAAD,EAASC,OAAT,EAAqB;AAChC,MAAMC,YAAY,qBACbF,MADa,EAEbd,cAFa,CAAlB;;AAIA,MAAMiB,aAAa,qBACdF,OADc,EAEdT,eAFc,CAAnB;;AAIAP,EAAAA,MAAM,GAAG,8BAAWiB,YAAX,EAAyBC,aAAzB,CAAT;AACD,CAVD;;AAYA,IAAMC,aAAa,GAAG,SAAhBA,aAAgB,CAACC,MAAD,EAASC,UAAT;AAAA,SAAwBrB,MAAM,CAACsB,OAAP,CAAeF,MAAf,EAAuBC,UAAvB,CAAxB;AAAA,CAAtB;;AAEA,IAAME,SAAS,GAAG,SAAZA,SAAY,CAACC,QAAD,EAA4B;AAAA,MAAjBR,OAAiB,uEAAP,EAAO;;AAC5C,MAAIS,WAAW,GAAGC,eAAEC,IAAF,CAAO,CAAC,SAAD,CAAP,EAAoBX,OAApB,CAAlB;;AACA,MAAIY,iBAAJ;;AAEA,MAAIZ,OAAO,CAACa,OAAR,IAAmB,QAAOb,OAAO,CAACa,OAAf,MAA2B,QAAlD,EAA4D;AAC1DD,IAAAA,iBAAiB,GAAGT,aAAa,CAACH,OAAO,CAACa,OAAR,CAAgBT,MAAjB,EAAyBJ,OAAO,CAACa,OAAR,CAAgBR,UAAzC,CAAjC;AACAI,IAAAA,WAAW,CAACK,OAAZ,GAAsBF,iBAAtB;AACD;;AAED,MAAIZ,OAAO,CAACa,OAAR,IAAmB,QAAOb,OAAO,CAACa,OAAf,MAA2B,QAAlD,EAA4D;AAC1DD,IAAAA,iBAAiB,GAAGT,aAAa,CAACH,OAAO,CAACe,YAAR,CAAqBX,MAAtB,EAA8BJ,OAAO,CAACe,YAAR,CAAqBV,UAAnD,CAAjC;AACAI,IAAAA,WAAW,CAACO,UAAZ,GAAyB,CAAC,8BAAYJ,iBAAZ,CAAD,CAAzB;AACD;;AAGD,SAAO5B,MAAM,CAACuB,SAAP,CAAiBC,QAAjB,EAA2BC,WAA3B,CAAP;AACD,CAhBD;;AAkBA,IAAMQ,MAAM,GAAG,SAATA,MAAS,CAACC,IAAD,EAAOd,MAAP,EAAee,OAAf;AAAA,SAA2BnC,MAAM,CAACiC,MAAP,CAAcC,IAAd,EAAoBd,MAApB,EAA4Be,OAA5B,CAA3B;AAAA,CAAf;;eAEe;AAAEnC,EAAAA,MAAM,EAANA,MAAF;AAAUc,EAAAA,IAAI,EAAJA,IAAV;AAAgBS,EAAAA,SAAS,EAATA,SAAhB;AAA2BU,EAAAA,MAAM,EAANA,MAA3B;AAAmCd,EAAAA,aAAa,EAAbA;AAAnC,C","sourcesContent":["import { initTracer } from 'jaeger-client'\nimport { followsFrom } from 'opentracing'\nimport R from 'ramda'\n\nlet tracer\n\nconst DEFAULT_CONFIG = {\n  sampler: {\n    type: 'const',\n    param: 1\n  },\n  reporter: {\n    logSpans: true\n  }\n}\n\nconst DEFAULT_OPTIONS = {\n  logger: {\n    info(msg) {\n      console.log('INFO : ', msg)\n    },\n    error(msg) {\n      console.log('ERROR : ', msg)\n    }\n  }\n}\n\nconst init = (config, options) => {\n  const tracerConfig = {\n    ...config,\n    ...DEFAULT_CONFIG\n  }\n  const tracerOptions = {\n    ...options,\n    ...DEFAULT_OPTIONS\n  }\n  tracer = initTracer(tracerConfig, tracerOptions)\n}\n\nconst getParentSpan = (format, injectData) => tracer.extract(format, injectData)\n\nconst startSpan = (spanName, options = {}) => {\n  let spanOptions = R.omit(['isChild'], options)\n  let parentSpanContext\n  \n  if (options.isChild && typeof options.isChild === 'object') {\n    parentSpanContext = getParentSpan(options.isChild.format, options.isChild.injectData)\n    spanOptions.childOf = parentSpanContext\n  }\n\n  if (options.isChild && typeof options.isChild === 'object') {\n    parentSpanContext = getParentSpan(options.isFollowFrom.format, options.isFollowFrom.injectData)\n    spanOptions.references = [followsFrom(parentSpanContext)]\n  }\n\n  \n  return tracer.startSpan(spanName, spanOptions)\n}\n\nconst inject = (span, format, payload) => tracer.inject(span, format, payload)\n\nexport default { tracer, init, startSpan, inject, getParentSpan }\n"],"file":"index.js"}